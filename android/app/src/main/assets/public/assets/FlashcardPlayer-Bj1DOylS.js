import{a as Le,b as ze,u as $e,r as x,j as t}from"./index-fqoWOEOd.js";import{w as De,a as Be}from"./aiTimeout-DeA1Q-oz.js";import{A as We}from"./arrow-left-Co68oQub.js";import{C as _e}from"./clock-CZa3_aXS.js";import{T as qe}from"./thumbs-up-DHWBQpEt.js";import{L as Ue,X as Xe}from"./x-Bo1bPwFe.js";import{C as Ve}from"./chevron-left-Dp5Vzig4.js";import"./createLucideIcon-CvVNInVQ.js";var Re={};(function q(j,S,I,M){var D=!!(j.Worker&&j.Blob&&j.Promise&&j.OffscreenCanvas&&j.OffscreenCanvasRenderingContext2D&&j.HTMLCanvasElement&&j.HTMLCanvasElement.prototype.transferControlToOffscreen&&j.URL&&j.URL.createObjectURL),U=typeof Path2D=="function"&&typeof DOMMatrix=="function",X=function(){if(!j.OffscreenCanvas)return!1;var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var s=a.transferToImageBitmap();try{e.createPattern(s,"no-repeat")}catch{return!1}return!0}();function se(){}function B(a){var e=S.exports.Promise,s=e!==void 0?e:j.Promise;return typeof s=="function"?new s(a):(a(se,se),null)}var z=function(a,e){return{transform:function(s){if(a)return s;if(e.has(s))return e.get(s);var i=new OffscreenCanvas(s.width,s.height),o=i.getContext("2d");return o.drawImage(s,0,0),e.set(s,i),i},clear:function(){e.clear()}}}(X,new Map),$=function(){var a=Math.floor(16.666666666666668),e,s,i={},o=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(r){var d=Math.random();return i[d]=requestAnimationFrame(function n(c){o===c||o+a-1<c?(o=c,delete i[d],r()):i[d]=requestAnimationFrame(n)}),d},s=function(r){i[r]&&cancelAnimationFrame(i[r])}):(e=function(r){return setTimeout(r,a)},s=function(r){return clearTimeout(r)}),{frame:e,cancel:s}}(),be=function(){var a,e,s={};function i(o){function r(d,n){o.postMessage({options:d||{},callback:n})}o.init=function(n){var c=n.transferControlToOffscreen();o.postMessage({canvas:c},[c])},o.fire=function(n,c,m){if(e)return r(n,null),e;var v=Math.random().toString(36).slice(2);return e=B(function(f){function w(N){N.data.callback===v&&(delete s[v],o.removeEventListener("message",w),e=null,z.clear(),m(),f())}o.addEventListener("message",w),r(n,v),s[v]=w.bind(null,{data:{callback:v}})}),e},o.reset=function(){o.postMessage({reset:!0});for(var n in s)s[n](),delete s[n]}}return function(){if(a)return a;if(!I&&D){var o=["var CONFETTI, SIZE = {}, module = {};","("+q.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([o])))}catch(r){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",r),null}i(a)}return a}}(),V={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function ve(a,e){return e?e(a):a}function we(a){return a!=null}function b(a,e,s){return ve(a&&we(a[e])?a[e]:V[e],s)}function ye(a){return a<0?0:Math.floor(a)}function je(a,e){return Math.floor(Math.random()*(e-a))+a}function F(a){return parseInt(a,16)}function ne(a){return a.map(Me)}function Me(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:F(e.substring(0,2)),g:F(e.substring(2,4)),b:F(e.substring(4,6))}}function W(a){var e=b(a,"origin",Object);return e.x=b(e,"x",Number),e.y=b(e,"y",Number),e}function le(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function Ne(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function ie(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function Z(a,e,s,i,o,r,d,n,c){a.save(),a.translate(e,s),a.rotate(r),a.scale(i,o),a.arc(0,0,1,d,n,c),a.restore()}function ke(a){var e=a.angle*(Math.PI/180),s=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*s-Math.random()*s),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function Y(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var s=e.tick++/e.totalTicks,i=e.x+e.random*e.tiltCos,o=e.y+e.random*e.tiltSin,r=e.wobbleX+e.random*e.tiltCos,d=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-s)+")",a.beginPath(),U&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill(ce(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(r-i)*.1,Math.abs(d-o)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var n=Math.PI/10*e.wobble,c=Math.abs(r-i)*.1,m=Math.abs(d-o)*.1,v=e.shape.bitmap.width*e.scalar,f=e.shape.bitmap.height*e.scalar,w=new DOMMatrix([Math.cos(n)*c,Math.sin(n)*c,-Math.sin(n)*m,Math.cos(n)*m,e.x,e.y]);w.multiplySelf(new DOMMatrix(e.shape.matrix));var N=a.createPattern(z.transform(e.shape.bitmap),"no-repeat");N.setTransform(w),a.globalAlpha=1-s,a.fillStyle=N,a.fillRect(e.x-v/2,e.y-f/2,v,f),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(r-i)*e.ovalScalar,Math.abs(d-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):Z(a,e.x,e.y,Math.abs(r-i)*e.ovalScalar,Math.abs(d-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var h=Math.PI/2*3,k=4*e.scalar,T=8*e.scalar,C=e.x,A=e.y,L=5,P=Math.PI/L;L--;)C=e.x+Math.cos(h)*T,A=e.y+Math.sin(h)*T,a.lineTo(C,A),h+=P,C=e.x+Math.cos(h)*k,A=e.y+Math.sin(h)*k,a.lineTo(C,A),h+=P;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(o)),a.lineTo(Math.floor(r),Math.floor(d)),a.lineTo(Math.floor(i),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function Ce(a,e,s,i,o){var r=e.slice(),d=a.getContext("2d"),n,c,m=B(function(v){function f(){n=c=null,d.clearRect(0,0,i.width,i.height),z.clear(),o(),v()}function w(){I&&!(i.width===M.width&&i.height===M.height)&&(i.width=a.width=M.width,i.height=a.height=M.height),!i.width&&!i.height&&(s(a),i.width=a.width,i.height=a.height),d.clearRect(0,0,i.width,i.height),r=r.filter(function(N){return Y(d,N)}),r.length?n=$.frame(w):f()}n=$.frame(w),c=f});return{addFettis:function(v){return r=r.concat(v),m},canvas:a,promise:m,reset:function(){n&&$.cancel(n),c&&c()}}}function oe(a,e){var s=!a,i=!!b(e||{},"resize"),o=!1,r=b(e,"disableForReducedMotion",Boolean),d=D&&!!b(e||{},"useWorker"),n=d?be():null,c=s?le:Ne,m=a&&n?!!a.__confetti_initialized:!1,v=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,f;function w(h,k,T){for(var C=b(h,"particleCount",ye),A=b(h,"angle",Number),L=b(h,"spread",Number),P=b(h,"startVelocity",Number),K=b(h,"decay",Number),ue=b(h,"gravity",Number),G=b(h,"drift",Number),Q=b(h,"colors",ne),he=b(h,"ticks",Number),fe=b(h,"shapes"),Te=b(h,"scalar"),Ee=!!b(h,"flat"),me=W(h),J=C,ee=[],Ie=a.width*me.x,Pe=a.height*me.y;J--;)ee.push(ke({x:Ie,y:Pe,angle:A,spread:L,startVelocity:P,color:Q[J%Q.length],shape:fe[je(0,fe.length)],ticks:he,decay:K,gravity:ue,drift:G,scalar:Te,flat:Ee}));return f?f.addFettis(ee):(f=Ce(a,ee,c,k,T),f.promise)}function N(h){var k=r||b(h,"disableForReducedMotion",Boolean),T=b(h,"zIndex",Number);if(k&&v)return B(function(P){P()});s&&f?a=f.canvas:s&&!a&&(a=ie(T),document.body.appendChild(a)),i&&!m&&c(a);var C={width:a.width,height:a.height};n&&!m&&n.init(a),m=!0,n&&(a.__confetti_initialized=!0);function A(){if(n){var P={getBoundingClientRect:function(){if(!s)return a.getBoundingClientRect()}};c(P),n.postMessage({resize:{width:P.width,height:P.height}});return}C.width=C.height=null}function L(){f=null,i&&(o=!1,j.removeEventListener("resize",A)),s&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,m=!1)}return i&&!o&&(o=!0,j.addEventListener("resize",A,!1)),n?n.fire(h,C,L):w(h,C,L)}return N.reset=function(){n&&n.reset(),f&&f.reset()},N}var _;function H(){return _||(_=oe(null,{useWorker:!0,resize:!0})),_}function ce(a,e,s,i,o,r,d){var n=new Path2D(a),c=new Path2D;c.addPath(n,new DOMMatrix(e));var m=new Path2D;return m.addPath(c,new DOMMatrix([Math.cos(d)*o,Math.sin(d)*o,-Math.sin(d)*r,Math.cos(d)*r,s,i])),m}function Se(a){if(!U)throw new Error("path confetti are not supported in this browser");var e,s;typeof a=="string"?e=a:(e=a.path,s=a.matrix);var i=new Path2D(e),o=document.createElement("canvas"),r=o.getContext("2d");if(!s){for(var d=1e3,n=d,c=d,m=0,v=0,f,w,N=0;N<d;N+=2)for(var h=0;h<d;h+=2)r.isPointInPath(i,N,h,"nonzero")&&(n=Math.min(n,N),c=Math.min(c,h),m=Math.max(m,N),v=Math.max(v,h));f=m-n,w=v-c;var k=10,T=Math.min(k/f,k/w);s=[T,0,0,T,-Math.round(f/2+n)*T,-Math.round(w/2+c)*T]}return{type:"path",path:e,matrix:s}}function de(a){var e,s=1,i="#000000",o='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,s="scalar"in a?a.scalar:s,o="fontFamily"in a?a.fontFamily:o,i="color"in a?a.color:i);var r=10*s,d=""+r+"px "+o,n=new OffscreenCanvas(r,r),c=n.getContext("2d");c.font=d;var m=c.measureText(e),v=Math.ceil(m.actualBoundingBoxRight+m.actualBoundingBoxLeft),f=Math.ceil(m.actualBoundingBoxAscent+m.actualBoundingBoxDescent),w=2,N=m.actualBoundingBoxLeft+w,h=m.actualBoundingBoxAscent+w;v+=w+w,f+=w+w,n=new OffscreenCanvas(v,f),c=n.getContext("2d"),c.font=d,c.fillStyle=i,c.fillText(e,N,h);var k=1/s;return{type:"bitmap",bitmap:n.transferToImageBitmap(),matrix:[k,0,0,k,-v*k/2,-f*k/2]}}S.exports=function(){return H().apply(this,arguments)},S.exports.reset=function(){H().reset()},S.exports.create=oe,S.exports.shapeFromPath=Se,S.exports.shapeFromText=de})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Re,!1);const Ze=Re.exports;Re.exports.create;function Ye(q,j){let{repetition:S=0,interval:I=0,efactor:M=2.5}=q;j<3?(S=0,I=0):(S+=1,S===1?I=.5:I=Math.ceil(I*M)),M=Math.max(1.3,M+(.1-(5-j)*(.08+(5-j)*.02)));const D=Date.now()+I*24*60*60*1e3;return{repetition:S,interval:I,efactor:M,nextReview:D}}function ra(){var Oe;const{decks:q,setDecks:j}=Le(),{id:S}=ze(),I=$e(),[M,D]=x.useState(0),[U,X]=x.useState(!1),[se,B]=x.useState(""),[z,$]=x.useState(!1),[be,V]=x.useState(!1),[ve,we]=x.useState(0),[b,ye]=x.useState(!1),[je,F]=x.useState(!1),[ne,Me]=x.useState([]),[W,le]=x.useState([]),[Ne,ie]=x.useState(!1),[Z,ke]=x.useState(()=>new Set),[Y,Ce]=x.useState(0),[oe,_]=x.useState(0),[H,ce]=x.useState(!1),Se=(Oe=window==null?void 0:window.Capacitor)==null?void 0:Oe.isNativePlatform(),de="https://brillian-flashcard-backend.onrender.com",a=q.find(l=>String(l.id)===S),[e]=x.useState(()=>{const l=Date.now();return a.cards.filter(u=>new Date(u.nextReview).getTime()<=l)}),s=e,o=s.length-M,r=s[M],{userXP:d,setUserXP:n}=Le(),[c,m]=x.useState(""),[v,f]=x.useState(!1),[w,N]=x.useState(0),{learningPrefs:h,setLearningPrefs:k}=Le(),[T,C]=x.useState(()=>new Set),[A,L]=x.useState(""),[P,K]=x.useState(!1),ue=x.useRef(M),G=(l,u,p)=>{let y=10;return l?(y+=10,p&&(y+=5)):y+=2,p?y+=Math.floor(10*(1-u/10)):u>20&&(y-=2),y};if(x.useEffect(()=>{const l=ue.current;if(l!==M){const u=a.cards[l];if(u&&Z.has(u.id)&&!T.has(u.id)){const y={...h},E=(u.answer||"").toLowerCase(),ae=["for example","e.g.","เช่น","ตัวอย่าง","อาทิ"],te=["because","therefore","เพราะ","ดังนั้น","เนื่องจาก"],xe=["definition","summary","step","explain","คำจำกัดความ","สรุป","ขั้นตอน","อธิบาย"];u.needs_image&&(y.visual+=.05),ae.some(g=>E.includes(g))&&(y.realworld+=.05),te.some(g=>E.includes(g))&&(y.logical+=.05),xe.some(g=>E.includes(g))&&(y.verbal+=.05),!u.needs_image&&!ae.some(g=>E.includes(g))&&!te.some(g=>E.includes(g))&&!xe.some(g=>E.includes(g))&&(y.verbal+=.05);const Ae=Object.values(y).reduce((g,ge)=>g+ge,0)||1;Object.keys(y).forEach(g=>y[g]=y[g]/Ae),k(y);const pe=u.needs_image?"Visual":ae.some(g=>E.includes(g))?"Real-World":te.some(g=>E.includes(g))?"Logical":"Verbal";setTimeout(()=>{L(`+${Math.round(.05*100)}% ${pe}`),K(!0),setTimeout(()=>K(!1),2e3)},1e3),C(g=>new Set(g).add(u.id))}}ue.current=M},[M,Z,T,h,a.cards,k,C,L,K]),x.useEffect(()=>{b&&Ze({particleCount:150,spread:70,origin:{y:.6}})},[b]),x.useEffect(()=>{N(0)},[S]),x.useEffect(()=>{Ce(Date.now()),ce(!0)},[M]),x.useEffect(()=>{if(!r)return;const l=localStorage.getItem(`card-${r.id}-time`);l&&_(l)},[r]),x.useEffect(()=>{const l=setInterval(()=>{we(u=>u+1)},1e3);return()=>clearInterval(l)},[]),M>=s.length||s.length===0)return t.jsxs("div",{className:"p-4 h-full w-full text-black flex items-center justify-center flex-col",children:[t.jsx("h2",{className:"text-2xl mb-4",children:"🎉 All done for now!"}),t.jsx("button",{onClick:()=>I(-1),className:"btn text-blue-700",children:"Back to Deck"})]});const Q=l=>{switch(l){case"Remembering":return"text-blue-500";case"Understanding":return"text-green-500";case"Applying":return"text-yellow-500";default:return"text-gray-500"}};function he(){if(X(!0),H){const l=(Date.now()-Y)/1e3;_(l);const u=localStorage.getItem(`card-${r.id}-time`);(!u||l<u)&&localStorage.setItem(`card-${r.id}-time`,l.toFixed(2)),ce(!1)}}function fe(l){ke(u=>{const p=new Set(u);return p.has(l)?(p.delete(l),C(y=>{const E=new Set(y);return E.delete(l),E})):p.add(l),p})}async function Te(){$(!0);try{const{data:l}=await De(Be.post(`${de}/api/explanation`,{question:r.question,answer:r.answer}),2e4,{explanation:"หินอัคนีพุ คือ หินที่เกิดจากการเย็นตัวและแข็งตัวของแมกมาใต้ผิวโลก โดยแมกมาเหล่านี้ถูกขับพุ่งออกมาจากใต้พื้นโลกผ่านกระบวนการภูเขาไฟระเบิด หรือการปะทุของภูเขาไฟ เมื่อแมกมาเหล่านี้สัมผัสกับอากาศหรือน้ำ อุณหภูมิและความดันที่ลดลงทำให้แร่ธาตุต่างๆ ในแมกมาเริ่มแข็งตัวและตกผลึก กลายเป็นหินอัคนีพุที่มีเนื้อละเอียดและโครงสร้างที่มีลักษณะเฉพาะ หินบะซอลต์ หินไรโอไลต์ และหินแอนดีไซต์ เป็นตัวอย่างของหินอัคนีพุที่พบได้ทั่วไป หินเหล่านี้มีลักษณะเนื้อละเอียดและมักจะมีสีเข้ม หินบะซอลต์มักพบในบริเวณที่มีการปะทุของภูเขาไฟใต้มหาสมุทร หินไรโอไลต์และหินแอนดีไซต์มักพบในบริเวณที่มีภูเขาไฟบนพื้นทวีป การเกิดของหินเหล่านี้จึงเกี่ยวข้องกับกระบวนการเคลื่อนที่ของแผ่นธรณีภาคและกระบวนการภูเขาไฟ ซึ่งทำให้เราเข้าใจถึงการเปลี่ยนแปลงของพื้นโลกและประวัติศาสตร์ของโลกเราได้ดีขึ้น"}),u=G(!0,0,!1,!0,!1);n(p=>p+u),m(`+${u} XP for the explantion!`),f(!0),setTimeout(()=>{f(!1)},2e3),B(l.explanation),V(!0)}catch(l){console.error(l),alert("Failed to fetch AI explanation")}finally{$(!1)}}function Ee(){I(`/deck/${a.id}`)}function me(){M<s.length-1?(D(M+1),X(!1),V(!1)):ye(!0)}async function J(l){const u=(Date.now()-Y)/1e3,p=localStorage.getItem(`card-${r.id}-time`),y=p?u<p:!1,E=G(l,u,y);n(re=>re+E),m(`Nice job! +${E} XP`),f(!0),setTimeout(()=>f(!1),2e3);const ae=l?5:1,{repetition:te,interval:xe,efactor:Ae,nextReview:pe}=Ye(r,ae),Fe=r.point,g=Fe+(l?6:-2),ge=Fe<=5&&g>5;ge&&(console.log(`Card ${r.id} just graduated!`),N(re=>re+1)),j(re=>re.map(O=>O.id!==a.id?O:{...O,cards:O.cards.map(R=>R.id===r.id?{...R,point:g,repetition:te,interval:xe,efactor:Ae,nextReview:pe}:R),due:O.cards.map(R=>R.id===r.id?{...R,nextReview:pe}:R).filter(R=>R.nextReview<=Date.now()).length,learned:ge?O.learned+1:O.learned})),X(!1),B(""),me()}async function ee(){ie(!0),F(!0);try{const{data:l}=await De(Be.post(`${de}/api/related-cards`,{question:r.question,answer:r.answer}),25e5,{cards:[{id:"mock1",question:"หินแอนดีไซต์มีลักษณะอย่างไร",answer:"เป็นหินอัคนีพุที่มีเนื้อละเอียดและสีเข้ม",keyword:"",needs_image:!1},{id:"mock2",question:"หินอัคนีพุสามารถนำไปใช้ประโยชน์อย่างไร",answer:"สามารถนำไปใช้เป็นวัสดุก่อสร้างและวัสดุในการทำถนน",keyword:"",needs_image:!1},{id:"mock3",question:"หินอัคนีพุคืออะไร",answer:"หินที่เกิดจากการเย็นตัวของแมกมาใต้ผิวโลก",keyword:"",needs_image:!1}]});Me(l.cards),le(l.cards.map(p=>p.id));const u=G(!0,0,!1,!1,!0);n(p=>p+u),m(`+${u} XP for exploring more!`),f(!0),setTimeout(()=>{f(!1)},2e3)}catch{alert("AI failed to generate extra cards"),F(!1)}finally{ie(!1)}}function Ie(l){le(u=>u.includes(l)?u.filter(p=>p!==l):[...u,l])}function Pe(){if(W.length===0)return F(!1);const l=ne.filter(u=>W.includes(u.id));j(u=>u.map(p=>p.id===a.id?{...p,cards:[...p.cards,...l],total:p.cards.length+l.length}:p)),F(!1)}return t.jsxs("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 w-full relative",children:[b&&t.jsx("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/40 backdrop-blur-sm",children:t.jsxs("div",{className:"rounded-xl bg-white p-8 shadow-xl text-center space-y-4",children:[t.jsx("h2",{className:"text-2xl font-bold text-black",children:"🎉 Great job!"}),t.jsx("p",{className:"text-gray-600",children:"You've reviewed every card due today!"}),t.jsx("p",{className:"text-gray-600",children:"Check back tomorrow for the next, perfectly-timed round."}),t.jsx("button",{onClick:()=>I(`/deck/${a.id}`),className:"rounded-md bg-blue-600 px-6 py-2 text-white hover:bg-blue-700",children:"Back to decks"})]})}),t.jsxs("header",{className:"flex justify-between items-center w-full max-w-6xl px-4 py-6",children:[t.jsxs("button",{onClick:Ee,className:"flex items-center gap-2 text-blue-600",children:[t.jsx(We,{size:20,color:"blue"}),"Exit"]}),t.jsxs("span",{className:"text-sm text-gray-700 ",children:[o," Cards left today| Elapsed Time: ",ve," sec"]})]}),t.jsxs("section",{className:"flex flex-col items-center gap-8 flex-1 w-full px-4 pb-6 justify-center",children:[v&&t.jsx("div",{className:"xp-message",children:c}),P&&t.jsx("div",{className:"style-message",children:A}),t.jsxs("span",{className:"text-xl text-gray-700 flex justify-center gap-2 font-bold",children:[t.jsx(_e,{size:26}),H?((Date.now()-Y)/1e3).toFixed(2):oe," sec"]}),t.jsx("div",{className:"perspective card w-full",onClick:he,children:t.jsxs("div",{className:`card-3d ${U?"rotate-x-180":""} w-full h-full`,children:[t.jsxs("div",{className:"card-face flex items-center justify-center bg-white rounded shadow p-6 border border-gray-200 front",children:[t.jsx("p",{className:"absolute top-4 left-4 text-6xl font-bold text-gray-300",children:"Q"}),t.jsx("div",{className:`absolute top-6 text-sm font-medium ${Q(r.taxonomy)}`,children:t.jsxs("strong",{children:["(",r.taxonomy,")"]})}),t.jsx("p",{className:"text-center text-xl font-semibold text-black",children:r.question})]}),t.jsxs("div",{className:"card-face rotate-y-180 flex items-center justify-center bg-white rounded shadow p-6 border border-gray-200 back",children:[t.jsx("p",{className:"absolute top-4 left-4 text-6xl font-bold text-gray-300",children:"A"}),t.jsx("div",{className:`absolute top-6 text-sm font-medium ${Q(r.taxonomy)}`,children:t.jsxs("strong",{children:["(",r.taxonomy,")"]})}),t.jsx("button",{onClick:l=>{l.stopPropagation(),fe(r.id)},className:"absolute top-3 right-3 rounded-full p-1 transition hover:bg-gray-100",children:t.jsx(qe,{size:20,className:Z.has(r.id)?"text-blue-500 fill-blue-500":"text-gray-400"})}),t.jsxs("div",{className:"flex flex-col items-center gap-1 h-full w-full justify-center",children:[r.image&&r.needs_image&&t.jsx("div",{className:"h-50 w-80 overflow-hidden rounded-lg sm:h-50 sm:w-70 overflow-hidden mb-4",children:t.jsx("img",{src:r.image,alt:r.keyword||"illustration",className:"mt-4 object-contain"})}),t.jsx("p",{className:"text-center text-xl font-semibold mb-4 text-black",children:r.answer})]})]})]})}),U?t.jsxs("div",{className:"flex flex-wrap justify-between tabby",children:[t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[t.jsx("button",{onClick:()=>J(!0),className:"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Remembered"}),t.jsx("button",{onClick:()=>J(!1),className:"px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Try Again"})]}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[t.jsxs("button",{onClick:Te,className:"px-6 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 flex items-center gap-2 ai-x-button button animated-gradient",children:[t.jsx(Ue,{size:20}),"AI Explanation"]}),t.jsx("button",{onClick:ee,className:"px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 add-more-button button",children:"Add More Like This"}),je&&t.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:t.jsxs("div",{className:"w-full max-w-lg rounded-lg bg-white shadow-xl",children:[t.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("h3",{className:"text-lg font-bold text-black",children:"New flashcards"}),t.jsx("p",{className:"text-gray-600",children:"Cards will be added to the back of the deck"})]}),t.jsx("button",{onClick:()=>F(!1),className:"rounded p-1 hover:bg-gray-100",children:t.jsx(Xe,{size:18})})]}),Ne?t.jsxs("div",{className:"flex flex-col items-center gap-3 py-10",children:[t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"}),t.jsx("p",{children:"Generating…"})]}):t.jsx("div",{className:"max-h-80 space-y-3 overflow-y-auto p-4",children:ne.map(l=>t.jsxs("label",{className:"flex cursor-pointer gap-3 rounded border p-3 hover:bg-gray-50",children:[t.jsx("input",{type:"checkbox",checked:W.includes(l.id),onChange:()=>Ie(l.id),className:"mt-1"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-black",children:l.question}),t.jsx("p",{className:"text-sm text-gray-600",children:l.answer})]})]},l.id))}),t.jsxs("div",{className:"flex justify-end gap-2 border-t px-4 py-3",children:[t.jsx("button",{onClick:()=>F(!1),className:"rounded border px-4 py-2 text-gray-700 hover:bg-gray-100",children:"Cancel"}),t.jsx("button",{onClick:Pe,disabled:W.length===0,className:"rounded bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:"Add to deck"})]})]})})]})]}):t.jsx("button",{onClick:he,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Show Answer"})]}),z&&t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:t.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 bg-white rounded shadow ",children:[t.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent animate-spin rounded-full"}),t.jsx("p",{className:"text-black",children:"Fetching AI Explanation..."})]})}),t.jsxs("aside",{className:`fixed inset-y-0 right-0 w-80 md:w-96 bg-white border-l shadow-lg
              transform transition-transform duration-300
              ${be?"translate-x-0":"translate-x-full"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b",children:[t.jsx("button",{onClick:()=>V(!1),className:"p-1 rounded hover:bg-gray-100",children:t.jsx(Ve,{size:20,color:"black"})}),t.jsx("h2",{className:"font-bold text-lg text-black",children:"AI Explanation"})]}),t.jsxs("div",{className:"p-4 overflow-y-auto text-black space-y-4",children:[t.jsxs("p",{children:[t.jsx("span",{className:"font-semibold",children:"Q:"})," ",r.question]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-semibold",children:"A:"})," ",r.answer]}),t.jsx("hr",{}),z?t.jsxs("div",{className:"flex flex-col items-center gap-3 py-8",children:[t.jsx("div",{className:"w-8 h-8 border-4 border-indigo-600 border-t-transparent animate-spin rounded-full"}),t.jsx("p",{children:"Fetching explanation…"})]}):t.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:se})]})]})]})}export{ra as default};
